<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard - BAYYTI-B1</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico?v=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.0">
    <link rel="apple-touch-icon" href="/favicon.ico?v=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans+Condensed:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/analytics.css?v=2.0">
    <link rel="stylesheet" href="css/analytics-enhanced.css">
    <link rel="stylesheet" href="css/mobile-header-enhancement.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <!-- Global Loader -->
    <div class="global-loader" id="globalLoader">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <div class="loader-text">Loading...</div>
        </div>
    </div>

    <!-- Red Header Bar (Same as index.html) -->
    <header class="top-header">
        <div class="header-container">
            <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Menu">
                <i class="fa-solid fa-ellipsis-vertical"></i>
            </button>
            <div class="header-left">
                <div class="logo logo-setup-container">
                    <a href="space.html">
                        <img src="TIONESETUP.png" alt="BAYYTI Logo" class="logo-setup-image">
                    </a>
                </div>
            </div>
            <div class="header-center">
                <div class="header-datetime header-clock-large" id="header-datetime">
                    <i class="fa-solid fa-clock"></i>
                    <span id="header-time">--:--</span>
                    <span class="datetime-separator">•</span>
                    <span id="header-date">--- --, ----</span>
                </div>
            </div>
            <div class="header-right">
                <button class="header-icon-btn" id="alertBtn" title="Alerts & Warnings">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    <span class="alert-counter" id="alertCounter">0</span>
                </button>
                <button class="header-icon-btn" id="notificationBtn" title="System Notifications">
                    <i class="fa-solid fa-bell"></i>
                    <span class="notification-badge" id="notificationBadge">0</span>
                </button>
                <button class="header-icon-btn" id="updateBtnMain" title="Check for system updates">
                    <i class="fa-solid fa-rotate"></i>
                    <span class="update-indicator" id="updateIndicator"></span>
                </button>
                <button class="header-icon-btn drag-toggle-btn" id="dragToggleBtn" title="Enable/Disable Drag & Drop">
                    <i class="fa-solid fa-grip-vertical"></i>
                </button>
                <a href="space.html" class="header-icon-btn" title="Space Dashboard">
                    <i class="fa-solid fa-rocket"></i>
                </a>
                <a href="emergency.html" class="header-icon-btn" title="Emergency Controls" style="background: rgba(220, 53, 69, 0.2);">
                    <i class="fa-solid fa-fire-extinguisher"></i>
                </a>
                <a href="hardware.html" class="header-icon-btn" title="Hardware Schema">
                    <img src="icons/HARDWARE.png" alt="Hardware" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <a href="controls.html" class="header-icon-btn" title="User & System Controls">
                    <i class="fa-solid fa-sliders"></i>
                </a>
                <a href="../PI_simulation/device_registration.html" class="header-icon-btn" title="PI Data Simulation">
                    <i class="fa-solid fa-microchip"></i>
                </a>
                <a href="ai.html" class="header-icon-btn" title="AI Model Testing">
                    <img src="icons/AI.png" alt="AI" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <a href="support.html" class="header-icon-btn" title="Support">
                    <i class="fa-solid fa-circle-question"></i>
                </a>
                <a href="faq.html" class="header-icon-btn" title="FAQ">
                    <i class="fa-solid fa-book"></i>
                </a>
                <a href="#" class="header-icon-btn" id="setup-link" aria-label="Return to Setup" title="Return to Setup">
                    <img src="icons/SETUP.png" alt="Setup" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <button class="header-icon-btn reboot-btn" id="rebootBtn" title="Reboot System">
                    <i class="fa-solid fa-power-off"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Secondary Navigation Bar -->
    <nav class="secondary-nav">
        <div class="nav-container">
            <div class="nav-title">
                <i class="fa-solid fa-chart-line"></i>
                <span>Performance Analytics</span>
            </div>
        </div>
    </nav>

    <!-- Mobile Page Title Bar -->
    <div class="mobile-page-title analytics-page show">
        <div class="mobile-page-title-content">
            <div class="mobile-page-title-icon">
                <i class="fa-solid fa-chart-line"></i>
            </div>
            <div class="mobile-page-title-text">Performance Benchmarks</div>
        </div>
    </div>

    <!-- Mobile Sidebar Menu -->
    <div class="mobile-sidebar" id="mobile-sidebar">
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        <div class="sidebar-content">
            <div class="sidebar-header">
                <button class="sidebar-close" id="sidebar-close" aria-label="Close Menu">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <nav class="sidebar-nav">
                <a href="space.html" class="sidebar-item" title="Space Dashboard">
                    <i class="fa-solid fa-rocket"></i>
                </a>
                <a href="analytics.html" class="sidebar-item active" title="Analytics">
                    <i class="fa-solid fa-chart-line"></i>
                </a>
                <a href="emergency.html" class="sidebar-item" title="Emergency Controls">
                    <i class="fa-solid fa-fire-extinguisher"></i>
                </a>
                <a href="hardware.html" class="sidebar-item" title="Hardware Schema">
                    <img src="icons/HARDWARE.png" alt="Hardware" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <a href="controls.html" class="sidebar-item" title="User & System Controls">
                    <i class="fa-solid fa-sliders"></i>
                </a>
                <a href="../PI_simulation/device_registration.html" class="sidebar-item" title="PI Data Simulation">
                    <i class="fa-solid fa-microchip"></i>
                </a>
                <a href="ai.html" class="sidebar-item" title="AI Model Testing">
                    <img src="icons/AI.png" alt="AI" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <a href="support.html" class="sidebar-item" title="Support">
                    <i class="fa-solid fa-circle-question"></i>
                </a>
                <a href="faq.html" class="sidebar-item" title="FAQ">
                    <i class="fa-solid fa-book"></i>
                </a>
                <a href="#" class="sidebar-item" id="setup-link" title="Return to Setup">
                    <img src="icons/SETUP.png" alt="Setup" style="width: 20px; height: 20px; object-fit: contain;">
                </a>
                <button class="sidebar-item" id="rebootBtnMobile" title="Reboot System">
                    <i class="fa-solid fa-power-off"></i>
                </button>
            </nav>
        </div>
    </div>

    <div class="container">
        <!-- Page Title -->
        <div class="page-title-section">
            <div class="page-title-icon">
                <i class="fa-solid fa-chart-line"></i>
            </div>
            <h1 class="page-title" data-i18n="nav-analytics">Performance Benchmarks</h1>
        </div>

        <!-- Top Charts Row: Suspected Farmland Statistics + Area of Doubt -->
        <div class="charts-row" style="margin-bottom: 20px; grid-template-columns: 1.5fr 1fr;">
            <!-- Suspected Farmland Statistics -->
            <div class="chart-card" data-draggable="true">
                <div class="chart-card-header">
                    <div>
                        <h3><i class="fa-solid fa-grip-vertical" style="color: #999; margin-right: 0.5rem; cursor: move;"></i><span data-i18n="suspected-farmland">Suspected farmland statistics</span></h3>
                        <p class="chart-subtitle" data-i18n="ai-doubt-stats">AI doubt category statistics</p>
                        <div class="chart-refresh-info">
                            <i class="fa-solid fa-rotate refresh-icon"></i>
                            <span class="refresh-text">Auto-refresh: <strong id="farmlandRefreshTimer">30s</strong></span>
                        </div>
                    </div>
                    <button class="export-btn" onclick="exportChartToPDF('farmlandStatsChart', 'Farmland_Statistics')" title="Export to PDF">
                        <i class="fa-solid fa-file-pdf"></i>
                    </button>
                </div>
                <div class="chart-header">
                    <span class="issue-badge">2018 Issue 1: 2600</span>
                    <span class="live-indicator"><i class="fa-solid fa-circle"></i> Live</span>
                </div>
                <canvas id="farmlandStatsChart"></canvas>
                
                <!-- Real-time Calculations -->
                <div class="chart-calculations">
                    <div class="calc-item">
                        <i class="fa-solid fa-chart-line"></i>
                        <div>
                            <span class="calc-label">Trend Analysis</span>
                            <span class="calc-value success">+15.2% this month</span>
                        </div>
                    </div>
                    <div class="calc-item">
                        <i class="fa-solid fa-brain"></i>
                        <div>
                            <span class="calc-label">AI Confidence</span>
                            <span class="calc-value" id="aiConfidence">87.5%</span>
                        </div>
                    </div>
                    <div class="calc-item">
                        <i class="fa-solid fa-database"></i>
                        <div>
                            <span class="calc-label">Data Points</span>
                            <span class="calc-value" id="dataPoints">1,247</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Area of Doubt (Enhanced) -->
            <div class="chart-card">
                <div class="chart-card-header">
                    <div>
                        <h3 data-i18n="area-of-doubt">Area of doubt</h3>
                        <p class="chart-subtitle">Real-time monitoring & analysis</p>
                        <div class="chart-refresh-info">
                            <i class="fa-solid fa-rotate refresh-icon"></i>
                            <span class="refresh-text">Auto-refresh: <strong id="doubtRefreshTimer">30s</strong></span>
                        </div>
                    </div>
                    <div class="chart-actions">
                        <button class="zone-select-btn" onclick="openZoneSelector()" title="Select Zone for Analysis">
                            <i class="fa-solid fa-map-location-dot"></i>
                        </button>
                        <button class="export-btn" onclick="exportChartToPDF('areaDonutChart', 'Area_of_Doubt')" title="Export to PDF">
                            <i class="fa-solid fa-file-pdf"></i>
                        </button>
                    </div>
                </div>
                <div class="donut-container">
                    <canvas id="areaDonutChart"></canvas>
                    <div class="donut-center">
                        <div class="donut-value">2,600</div>
                        <div class="donut-label" data-i18n="total-area">Total Area</div>
                    </div>
                </div>
                
                <!-- Detail Indicators -->
                <div class="doubt-indicators">
                    <div class="indicator-item">
                        <div class="indicator-icon high-doubt">
                            <i class="fa-solid fa-triangle-exclamation"></i>
                        </div>
                        <div class="indicator-content">
                            <span class="indicator-label">High Doubt</span>
                            <span class="indicator-value">880 ha</span>
                            <div class="indicator-mini-chart">
                                <div class="mini-bar" style="width: 75%; background: #f44336;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator-item">
                        <div class="indicator-icon medium-doubt">
                            <i class="fa-solid fa-exclamation"></i>
                        </div>
                        <div class="indicator-content">
                            <span class="indicator-label">Medium Doubt</span>
                            <span class="indicator-value">1,120 ha</span>
                            <div class="indicator-mini-chart">
                                <div class="mini-bar" style="width: 55%; background: #ff9800;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="indicator-item">
                        <div class="indicator-icon low-doubt">
                            <i class="fa-solid fa-circle-info"></i>
                        </div>
                        <div class="indicator-content">
                            <span class="indicator-label">Low Doubt</span>
                            <span class="indicator-value">600 ha</span>
                            <div class="indicator-mini-chart">
                                <div class="mini-bar" style="width: 35%; background: #4caf50;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Benchmarks -->
        <div class="benchmarks-section">
            <div class="section-header">
                <h2><i class="fa-solid fa-chart-column"></i> Performance Benchmarks</h2>
            </div>
            
            <!-- Top Stats Cards (Moved Here) -->
            <div class="top-stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <h3>Fields needing irrigation</h3>
                        <div class="stat-value" id="fieldsNeedingIrrigation">170</div>
                        <div class="stat-change positive">MoM +10%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <h3>Area of doubt</h3>
                        <div class="stat-value" id="areaOfDoubt">880</div>
                        <div class="stat-change positive">MoM +20%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M9 11l3 3L22 4"/>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <h3>Manual override events</h3>
                        <div class="stat-value" id="manualOverrides">0</div>
                        <div class="stat-change negative">MoM -10%</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <h3>Inactive zones</h3>
                        <div class="stat-value" id="inactiveZones">255</div>
                        <div class="stat-change positive">MoM +40%</div>
                    </div>
                </div>
            </div>
            
            <div class="benchmarks-grid">
            </div>
        </div>

        <!-- Zone Selection with Map -->
        <div class="zone-map-section" id="zoneMapSection" style="display: none;">
            <div class="zone-selector-card">
                <div class="zone-selector-header">
                    <h3><i class="fa-solid fa-map-location-dot"></i> Zone Selection & Map View</h3>
                    <div class="map-controls">
                        <button class="map-control-btn" id="toggleMapBtn" title="Hide Map">
                            <i class="fa-solid fa-eye-slash"></i>
                        </button>
                        <button class="map-control-btn" id="zoomInBtn" title="Zoom In">
                            <i class="fa-solid fa-plus"></i>
                        </button>
                        <button class="map-control-btn" id="zoomOutBtn" title="Zoom Out">
                            <i class="fa-solid fa-minus"></i>
                        </button>
                        <button class="map-control-btn" id="resetViewBtn" title="Reset View">
                            <i class="fa-solid fa-expand"></i>
                        </button>
                    </div>
                </div>
                <div class="zone-map-container">
                    <div class="zone-map" id="zoneMap">
                        <div id="realMap" style="width: 100%; height: 400px; border-radius: 8px;"></div>
                    </div>
                    <div class="zone-list-sidebar">
                        <h4>Active Zones</h4>
                        <div class="zone-list" id="zoneList">
                            <!-- Zones will be loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Left Sidebar - Weather -->
            <aside class="weather-sidebar">
                <div class="weather-icon">
                    <svg viewBox="0 0 200 200" width="120" height="120">
                        <circle cx="80" cy="80" r="60" fill="#1e5631"/>
                        <circle cx="120" cy="100" r="50" fill="#2d7a3e"/>
                        <rect x="125" y="80" width="15" height="40" fill="#4a9f5e" rx="3"/>
                        <rect x="145" y="70" width="15" height="50" fill="#4a9f5e" rx="3"/>
                        <rect x="165" y="60" width="15" height="60" fill="#5db36e" rx="3"/>
                    </svg>
                </div>

                <div class="temperature">
                    <span id="currentTemp">12</span>°C
                </div>
                <div class="time" id="currentTime">Monday 16:30</div>

                <div class="weather-info">
                    <div class="weather-item">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#4a9f5e" stroke-width="2">
                            <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/>
                        </svg>
                        <span id="weatherCondition">Mostly Cloudy</span>
                    </div>
                    <div class="weather-item">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#4a9f5e" stroke-width="2">
                            <line x1="12" y1="2" x2="12" y2="6"/>
                            <line x1="12" y1="18" x2="12" y2="22"/>
                            <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"/>
                            <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"/>
                            <line x1="2" y1="12" x2="6" y2="12"/>
                            <line x1="18" y1="12" x2="22" y2="12"/>
                        </svg>
                        <span>Rain – <span id="rainPercent">10</span>%</span>
                    </div>
                </div>
            </aside>

            <!-- Center Content -->
            <main class="main-content">
                <!-- Charts Row -->
                <div class="charts-row">
                </div>

                <!-- Weather Trends and Utilization -->
                <div class="charts-row">
                    <div class="chart-card wide">
                        <div class="chart-card-header">
                            <div class="chart-header-row">
                                <h3>Weather Trends</h3>
                                <span class="time-badge">Last 20 days</span>
                            </div>
                            <button class="export-btn" onclick="exportChartToPDF('weatherTrendsChart', 'Weather_Trends')" title="Export to PDF">
                                <i class="fa-solid fa-file-pdf"></i>
                                Export PDF
                            </button>
                        </div>
                        <div class="weather-summary">
                            <span class="weather-stat">20°C 60mm</span>
                        </div>
                        <canvas id="weatherTrendsChart"></canvas>
                    </div>

                    <div class="chart-card">
                        <div class="chart-card-header">
                            <h3>Farmland Utilization</h3>
                            <button class="export-btn" onclick="exportChartToPDF('utilizationChart', 'Farmland_Utilization')" title="Export to PDF">
                                <i class="fa-solid fa-file-pdf"></i>
                            </button>
                        </div>
                        <div class="utilization-value" id="utilizationPercent">70%</div>
                        <canvas id="utilizationChart"></canvas>
                    </div>
                </div>

            </main>
        </div>
    </div>

    <!-- Footer - Clean Light Design -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="logofooter.png" alt="TiOne Logo" class="footer-logo-img">
            </div>
            <div class="footer-text">
                <p>All content on this site. Copyright 2024 TiOne Smart Irrigation System. All rights reserved, including those for text and data mining, AI training, and similar technologies. For all open access content, the relevant licensing terms apply.</p>
            </div>
            <div class="footer-links">
                <a href="index.html">Dashboard</a>
                <a href="space.html">Space</a>
                <a href="analytics.html">Analytics</a>
                <a href="controls.html">Controls</a>
                <a href="support.html">Support</a>
            </div>
        </div>
    </footer>

    <!-- Notification Panel -->
    <div class="notification-panel" id="notificationPanel">
        <div class="notification-header">
            <h3><i class="fa-solid fa-bell"></i> Notifications</h3>
            <button class="close-panel" onclick="closeNotificationPanel()">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
        <div class="notification-list" id="notificationList">
            <!-- Notifications will be loaded here -->
        </div>
    </div>

    <!-- Update Modal -->
    <div id="updateModal" class="custom-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <i class="fa-solid fa-rotate modal-icon"></i>
                <h3 class="modal-title">System Update</h3>
            </div>
            <div class="modal-body" id="updateModalBody">
                <p>Checking for updates...</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" id="closeModalBtn">
                    <i class="fa-solid fa-times"></i>
                    <span>Close</span>
                </button>
                <button class="modal-btn modal-btn-confirm" id="installUpdateBtn" style="display: none;">
                    <i class="fa-solid fa-download"></i>
                    <span>Install Update</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Reboot Confirmation Modal -->
    <div id="rebootModal" class="custom-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <i class="fa-solid fa-power-off modal-icon"></i>
                <h3 class="modal-title">Reboot System</h3>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to reboot the BAYYTI-B1 system?</p>
                <p style="color: #FFC107; margin-top: 1rem;">
                    <i class="fa-solid fa-triangle-exclamation"></i>
                    This will temporarily interrupt irrigation operations.
                </p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" id="rebootModalCancel">
                    <i class="fa-solid fa-times"></i>
                    <span>Cancel</span>
                </button>
                <button class="modal-btn modal-btn-confirm" id="confirmRebootBtn">
                    <i class="fa-solid fa-power-off"></i>
                    <span>Reboot Now</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Zone Selector Modal -->
    <div id="zoneSelectorModal" class="custom-modal" style="display: none;">
        <div class="modal-overlay" onclick="closeZoneSelector()"></div>
        <div class="modal-content zone-modal-content">
            <div class="modal-header">
                <i class="fa-solid fa-map-location-dot modal-icon"></i>
                <h3 class="modal-title">Select Zone for Analysis</h3>
                <button class="modal-close-btn" onclick="closeZoneSelector()">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="zone-grid">
                    <div class="zone-option" data-zone="all" onclick="selectZone('all')">
                        <div class="zone-icon">
                            <i class="fa-solid fa-globe"></i>
                        </div>
                        <div class="zone-info">
                            <h4>All Zones</h4>
                            <p>Complete area analysis</p>
                        </div>
                    </div>
                    <div class="zone-option" data-zone="zone1" onclick="selectZone('zone1')">
                        <div class="zone-icon">
                            <i class="fa-solid fa-map-pin"></i>
                        </div>
                        <div class="zone-info">
                            <h4>Zone 1</h4>
                            <p>North sector - 650 ha</p>
                        </div>
                    </div>
                    <div class="zone-option" data-zone="zone2" onclick="selectZone('zone2')">
                        <div class="zone-icon">
                            <i class="fa-solid fa-map-pin"></i>
                        </div>
                        <div class="zone-info">
                            <h4>Zone 2</h4>
                            <p>East sector - 820 ha</p>
                        </div>
                    </div>
                    <div class="zone-option" data-zone="zone3" onclick="selectZone('zone3')">
                        <div class="zone-icon">
                            <i class="fa-solid fa-map-pin"></i>
                        </div>
                        <div class="zone-info">
                            <h4>Zone 3</h4>
                            <p>South sector - 730 ha</p>
                        </div>
                    </div>
                    <div class="zone-option" data-zone="zone4" onclick="selectZone('zone4')">
                        <div class="zone-icon">
                            <i class="fa-solid fa-map-pin"></i>
                        </div>
                        <div class="zone-info">
                            <h4>Zone 4</h4>
                            <p>West sector - 400 ha</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/analytics.js?v=3.0"></script>
    
    <script>
        // Zone selector functionality
        let selectedZone = 'all';
        
        function openZoneSelector() {
            document.getElementById('zoneSelectorModal').style.display = 'flex';
        }
        
        function closeZoneSelector() {
            document.getElementById('zoneSelectorModal').style.display = 'none';
        }
        
        function selectZone(zoneId) {
            selectedZone = zoneId;
            
            // Update visual selection
            document.querySelectorAll('.zone-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`[data-zone="${zoneId}"]`).classList.add('selected');
            
            // Update area of doubt data based on selected zone
            updateAreaOfDoubtData(zoneId);
            
            // Close modal
            closeZoneSelector();
            
            // Show notification
            if (typeof addNotification === 'function') {
                addNotification({
                    id: Date.now(),
                    type: 'info',
                    icon: 'fa-map-location-dot',
                    title: 'Zone Selected',
                    message: `Analysis updated for ${zoneId === 'all' ? 'All Zones' : zoneId.toUpperCase()}`,
                    time: new Date().toLocaleTimeString(),
                    timestamp: Date.now(),
                    priority: 'low'
                });
            }
        }
        
        function updateAreaOfDoubtData(zoneId) {
            // Zone-specific doubt data
            const zoneData = {
                all: { high: 880, medium: 1120, low: 600, total: 2600 },
                zone1: { high: 220, medium: 280, low: 150, total: 650 },
                zone2: { high: 320, medium: 350, low: 150, total: 820 },
                zone3: { high: 230, medium: 300, low: 200, total: 730 },
                zone4: { high: 110, medium: 190, low: 100, total: 400 }
            };
            
            const data = zoneData[zoneId] || zoneData.all;
            
            // Update indicators
            document.querySelector('.indicator-item:nth-child(1) .indicator-value').textContent = `${data.high} ha`;
            document.querySelector('.indicator-item:nth-child(2) .indicator-value').textContent = `${data.medium} ha`;
            document.querySelector('.indicator-item:nth-child(3) .indicator-value').textContent = `${data.low} ha`;
            
            // Update donut chart center
            document.querySelector('.donut-value').textContent = data.total.toLocaleString();
            
            // Update chart subtitle
            const subtitle = document.querySelector('.chart-card:nth-child(2) .chart-subtitle');
            if (subtitle) {
                subtitle.textContent = zoneId === 'all' ? 'Real-time monitoring & analysis' : `${zoneId.toUpperCase()} - Real-time monitoring & analysis`;
            }
        }
    </script>

    <!-- Drag and Drop System -->
    <script src="js/drag-drop.js?v=1.0"></script>
    
    <!-- Language System -->
    <script src="js/language.js?v=1.0"></script>
    
    <!-- Page Load Handler -->
    <script>
        window.addEventListener('load', function() {
            const loader = document.getElementById('globalLoader');
            if (loader) {
                setTimeout(() => {
                    loader.classList.add('hidden');
                }, 500);
            }
        });
    </script>

    <!-- Footer - Clean Light Design -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="logofooter.png" alt="TiOne Logo" class="footer-logo-img">
            </div>
            <div class="footer-text">
                <p>All content on this site. Copyright 2024 TiOne Smart Irrigation System. All rights reserved, including those for text and data mining, AI training, and similar technologies. For all open access content, the relevant licensing terms apply.</p>
            </div>
            <div class="footer-links">
                <a href="index.html">Dashboard</a>
                <a href="space.html">Space</a>
                <a href="analytics.html">Analytics</a>
                <a href="controls.html">Controls</a>
                <a href="support.html">Support</a>
            </div>
        </div>
    </footer>
</body>
</html>
